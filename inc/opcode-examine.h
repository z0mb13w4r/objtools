#ifndef __OPCODE_EXAMINE_H_
#define __OPCODE_EXAMINE_H_

//#define OPCODE_EXAMINE_DEBUG

#include "opcode.h"

#define OECODE_THIS                    (0)
#define OECODE_MNEMONIC                (1)
#define OECODE_OPERAND1                (2)
#define OECODE_OPERAND2                (3)
#define OECODE_OPERAND3                (4)

#define OCINSTRUCTION_ALIGNED          U64MASK(20)
#define OCINSTRUCTION_UNALIGNED        U64MASK(21)
#define OCINSTRUCTION_NOCHECK          U64MASK(22)
#define OCINSTRUCTION_NOTRACK          U64MASK(23)
#define OCINSTRUCTION_PI               U64MASK(24)
#define OCINSTRUCTION_ONE              U64MASK(25)
#define OCINSTRUCTION_TEN              U64MASK(26)
#define OCINSTRUCTION_TWO              U64MASK(27)
#define OCINSTRUCTION_ZERO             U64MASK(28)
#define OCINSTRUCTION_LOG2             U64MASK(29)
#define OCINSTRUCTION_LOGE             U64MASK(30)
#define OCINSTRUCTION_LOG10            U64MASK(31)
#define OCINSTRUCTION_EULER            U64MASK(32)
#define OCINSTRUCTION_LT               U64MASK(33)
#define OCINSTRUCTION_RT               U64MASK(34)
#define OCINSTRUCTION_A                U64MASK(35)
#define OCINSTRUCTION_AE               U64MASK(36)
#define OCINSTRUCTION_B                U64MASK(37)
#define OCINSTRUCTION_BE               U64MASK(38)
#define OCINSTRUCTION_E                U64MASK(39)
#define OCINSTRUCTION_G                U64MASK(40)
#define OCINSTRUCTION_GE               U64MASK(41)
#define OCINSTRUCTION_L                U64MASK(42)
#define OCINSTRUCTION_LE               U64MASK(43)
#define OCINSTRUCTION_NE               U64MASK(44)
#define OCINSTRUCTION_NS               U64MASK(45)
#define OCINSTRUCTION_O                U64MASK(46)
#define OCINSTRUCTION_S                U64MASK(47)
#define OCINSTRUCTION_BND              U64MASK(48)
#define OCINSTRUCTION_REP              U64MASK(49)
#define OCINSTRUCTION_LOCK             U64MASK(50)
#define OCINSTRUCTION_DATA             U64MASK(51)
#define OCINSTRUCTION_8BIT             U64MASK(52)
#define OCINSTRUCTION_16BIT            U64MASK(53)
#define OCINSTRUCTION_32BIT            U64MASK(54)
#define OCINSTRUCTION_64BIT            U64MASK(55)
#define OCINSTRUCTION_128BIT           U64MASK(56)
#define OCINSTRUCTION_256BIT           U64MASK(57)
#define OCINSTRUCTION_512BIT           U64MASK(58)
#define OCINSTRUCTION_OPERAND0         U64MASK(59)
#define OCINSTRUCTION_OPERAND1         U64MASK(60)
#define OCINSTRUCTION_OPERAND2         U64MASK(61)
#define OCINSTRUCTION_OPERAND3         U64MASK(62)

#define OCINSTRUCTION_REPE             (OCINSTRUCTION_REP | OCINSTRUCTION_E)
#define OCINSTRUCTION_REPNE            (OCINSTRUCTION_REP | OCINSTRUCTION_NE)
#define OCINSTRUCTION_DATA16           (OCINSTRUCTION_DATA | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_DATA32           (OCINSTRUCTION_DATA | OCINSTRUCTION_32BIT)

#define OCINSTRUCTION_CALL             ((0x01) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_ENDBR            ((0x02) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_JMP              ((0x03) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_BT               ((0x04) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_TEST             ((0x05) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_CMP              ((0x06) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_LEAVE            ((0x07) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_RET              ((0x08) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_HLT              ((0x09) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_PUSH             ((0x0a) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_POP              ((0x0b) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_ADD              ((0x0c) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_DEC              ((0x0d) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_DIV              ((0x0e) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_IDIV             ((0x0f) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_IMUL             ((0x10) | OCINSTRUCTION_OPERAND1 | OCINSTRUCTION_OPERAND2 | OCINSTRUCTION_OPERAND3)
#define OCINSTRUCTION_INC              ((0x11) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_MUL              ((0x12) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_NEG              ((0x13) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_NOT              ((0x14) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_SBB              ((0x15) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_SUB              ((0x16) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_AND              ((0x17) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_OR               ((0x18) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_ROx              ((0x19) | OCINSTRUCTION_OPERAND1 | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_SAx              ((0x1a) | OCINSTRUCTION_OPERAND1 | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_SHx              ((0x1b) | OCINSTRUCTION_OPERAND1 | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_XOR              ((0x1c) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_SETx             ((0x1d) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_MOV              ((0x1e) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVS             ((0x1f) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVSx            ((0x20) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVZx            ((0x21) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVSX            ((0x22) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVSXD           ((0x23) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVZX            ((0x24) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_LEA              ((0x25) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_CMOVx            ((0x26) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_XCHG             ((0x27) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_Cxxx             ((0x28) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_Cyyy             ((0x29) | OCINSTRUCTION_OPERAND0)
#define OCINSTRUCTION_NOP              ((0x2a) | OCINSTRUCTION_OPERAND0 | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_INS              ((0x2b) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_CMPS             ((0x2c) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_LODS             ((0x2d) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_OUTS             ((0x2e) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_SCAS             ((0x2f) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_STOS             ((0x30) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_CMPXCHG          ((0x31) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_FLD              ((0x32) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_FST              ((0x33) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_FSTP             ((0x34) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_FXCH             ((0x35) | OCINSTRUCTION_OPERAND1)
#define OCINSTRUCTION_MOVABS           ((0x36) | OCINSTRUCTION_OPERAND2)
#define OCINSTRUCTION_MOVDQA           ((0x37) | OCINSTRUCTION_OPERAND2 | OCINSTRUCTION_128BIT | OCINSTRUCTION_ALIGNED)
#define OCINSTRUCTION_MOVDQU           ((0x38) | OCINSTRUCTION_OPERAND2 | OCINSTRUCTION_128BIT | OCINSTRUCTION_UNALIGNED)
#define OCINSTRUCTION_MOVUPS           ((0x39) | OCINSTRUCTION_OPERAND2 | OCINSTRUCTION_128BIT | OCINSTRUCTION_UNALIGNED)
#define OCINSTRUCTION_MOVAPS           ((0x3a) | OCINSTRUCTION_OPERAND2 | OCINSTRUCTION_128BIT | OCINSTRUCTION_256BIT | OCINSTRUCTION_512BIT)
#define OCINSTRUCTION_FINIT            ((0x3b) | OCINSTRUCTION_OPERAND0)

#define OCINSTRUCTION_CALLB            (OCINSTRUCTION_CALL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_CALLL            (OCINSTRUCTION_CALL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CALLQ            (OCINSTRUCTION_CALL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_CALLW            (OCINSTRUCTION_CALL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_JA               (OCINSTRUCTION_JMP | OCINSTRUCTION_A)
#define OCINSTRUCTION_JAE              (OCINSTRUCTION_JMP | OCINSTRUCTION_AE)
#define OCINSTRUCTION_JB               (OCINSTRUCTION_JMP | OCINSTRUCTION_B)
#define OCINSTRUCTION_JBE              (OCINSTRUCTION_JMP | OCINSTRUCTION_BE)
#define OCINSTRUCTION_JE               (OCINSTRUCTION_JMP | OCINSTRUCTION_E)
#define OCINSTRUCTION_JG               (OCINSTRUCTION_JMP | OCINSTRUCTION_G)
#define OCINSTRUCTION_JGE              (OCINSTRUCTION_JMP | OCINSTRUCTION_GE)
#define OCINSTRUCTION_JL               (OCINSTRUCTION_JMP | OCINSTRUCTION_L)
#define OCINSTRUCTION_JLE              (OCINSTRUCTION_JMP | OCINSTRUCTION_LE)
#define OCINSTRUCTION_JNE              (OCINSTRUCTION_JMP | OCINSTRUCTION_NE)
#define OCINSTRUCTION_JNS              (OCINSTRUCTION_JMP | OCINSTRUCTION_NS)
#define OCINSTRUCTION_JO               (OCINSTRUCTION_JMP | OCINSTRUCTION_O)
#define OCINSTRUCTION_JS               (OCINSTRUCTION_JMP | OCINSTRUCTION_S)
#define OCINSTRUCTION_JMPL             (OCINSTRUCTION_JMP | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_JMPQ             (OCINSTRUCTION_JMP | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_BTS              (OCINSTRUCTION_BT | OCINSTRUCTION_S)
#define OCINSTRUCTION_TESTB            (OCINSTRUCTION_TEST | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_TESTL            (OCINSTRUCTION_TEST | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_TESTQ            (OCINSTRUCTION_TEST | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_TESTW            (OCINSTRUCTION_TEST | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_CMPB             (OCINSTRUCTION_CMP | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_CMPL             (OCINSTRUCTION_CMP | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CMPQ             (OCINSTRUCTION_CMP | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_CMPW             (OCINSTRUCTION_CMP | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_LEAVEB           (OCINSTRUCTION_LEAVE | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_LEAVEL           (OCINSTRUCTION_LEAVE | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_LEAVEQ           (OCINSTRUCTION_LEAVE | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_LEAVEW           (OCINSTRUCTION_LEAVE | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_NOPB             (OCINSTRUCTION_NOP | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_NOPL             (OCINSTRUCTION_NOP | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_NOPQ             (OCINSTRUCTION_NOP | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_NOPW             (OCINSTRUCTION_NOP | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ENDBR32          (OCINSTRUCTION_ENDBR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_ENDBR64          (OCINSTRUCTION_ENDBR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_RETB             (OCINSTRUCTION_RET | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_RETL             (OCINSTRUCTION_RET | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_RETQ             (OCINSTRUCTION_RET | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_RETW             (OCINSTRUCTION_RET | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_PUSHB            (OCINSTRUCTION_PUSH | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_PUSHL            (OCINSTRUCTION_PUSH | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_PUSHQ            (OCINSTRUCTION_PUSH | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_PUSHW            (OCINSTRUCTION_PUSH | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_POPB             (OCINSTRUCTION_POP | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_POPL             (OCINSTRUCTION_POP | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_POPQ             (OCINSTRUCTION_POP | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_POPW             (OCINSTRUCTION_POP | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ADDB             (OCINSTRUCTION_ADD | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_ADDL             (OCINSTRUCTION_ADD | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_ADDQ             (OCINSTRUCTION_ADD | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_ADDW             (OCINSTRUCTION_ADD | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_DECB             (OCINSTRUCTION_DEC | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_DECL             (OCINSTRUCTION_DEC | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_DECQ             (OCINSTRUCTION_DEC | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_DECW             (OCINSTRUCTION_DEC | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_DIVB             (OCINSTRUCTION_DIV | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_DIVL             (OCINSTRUCTION_DIV | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_DIVQ             (OCINSTRUCTION_DIV | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_DIVW             (OCINSTRUCTION_DIV | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_INCB             (OCINSTRUCTION_INC | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_INCL             (OCINSTRUCTION_INC | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_INCQ             (OCINSTRUCTION_INC | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_INCW             (OCINSTRUCTION_INC | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_IDIVB            (OCINSTRUCTION_IDIV | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_IDIVL            (OCINSTRUCTION_IDIV | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_IDIVQ            (OCINSTRUCTION_IDIV | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_IDIVW            (OCINSTRUCTION_IDIV | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_IMULB            (OCINSTRUCTION_IMUL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_IMULL            (OCINSTRUCTION_IMUL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_IMULQ            (OCINSTRUCTION_IMUL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_IMULW            (OCINSTRUCTION_IMUL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_MULB             (OCINSTRUCTION_MUL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_MULL             (OCINSTRUCTION_MUL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MULQ             (OCINSTRUCTION_MUL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MULW             (OCINSTRUCTION_MUL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_NEGB             (OCINSTRUCTION_NEG | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_NEGL             (OCINSTRUCTION_NEG | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_NEGQ             (OCINSTRUCTION_NEG | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_NEGW             (OCINSTRUCTION_NEG | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_NOTB             (OCINSTRUCTION_NOT | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_NOTL             (OCINSTRUCTION_NOT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_NOTQ             (OCINSTRUCTION_NOT | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_NOTW             (OCINSTRUCTION_NOT | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SBBB             (OCINSTRUCTION_SBB | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SBBL             (OCINSTRUCTION_SBB | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SBBQ             (OCINSTRUCTION_SBB | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SBBW             (OCINSTRUCTION_SBB | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SUBB             (OCINSTRUCTION_SUB | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SUBL             (OCINSTRUCTION_SUB | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SUBQ             (OCINSTRUCTION_SUB | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SUBW             (OCINSTRUCTION_SUB | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ANDB             (OCINSTRUCTION_AND | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_ANDL             (OCINSTRUCTION_AND | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_ANDQ             (OCINSTRUCTION_AND | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_ANDW             (OCINSTRUCTION_AND | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ORB              (OCINSTRUCTION_OR | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_ORL              (OCINSTRUCTION_OR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_ORQ              (OCINSTRUCTION_OR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_ORW              (OCINSTRUCTION_OR | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ROL              (OCINSTRUCTION_ROx | OCINSTRUCTION_LT)
#define OCINSTRUCTION_ROLB             (OCINSTRUCTION_ROL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_ROLL             (OCINSTRUCTION_ROL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_ROLQ             (OCINSTRUCTION_ROL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_ROLW             (OCINSTRUCTION_ROL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_ROR              (OCINSTRUCTION_ROx | OCINSTRUCTION_RT)
#define OCINSTRUCTION_RORB             (OCINSTRUCTION_ROR | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_RORL             (OCINSTRUCTION_ROR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_RORQ             (OCINSTRUCTION_ROR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_RORW             (OCINSTRUCTION_ROR | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SAL              (OCINSTRUCTION_SAx | OCINSTRUCTION_LT)
#define OCINSTRUCTION_SALB             (OCINSTRUCTION_SAL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SALL             (OCINSTRUCTION_SAL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SALQ             (OCINSTRUCTION_SAL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SALW             (OCINSTRUCTION_SAL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SAR              (OCINSTRUCTION_SAx | OCINSTRUCTION_RT)
#define OCINSTRUCTION_SARB             (OCINSTRUCTION_SAR | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SARL             (OCINSTRUCTION_SAR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SARQ             (OCINSTRUCTION_SAR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SARW             (OCINSTRUCTION_SAR | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SHL              (OCINSTRUCTION_SHx | OCINSTRUCTION_LT)
#define OCINSTRUCTION_SHLB             (OCINSTRUCTION_SHL | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SHLL             (OCINSTRUCTION_SHL | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SHLQ             (OCINSTRUCTION_SHL | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SHLW             (OCINSTRUCTION_SHL | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SHR              (OCINSTRUCTION_SHx | OCINSTRUCTION_RT)
#define OCINSTRUCTION_SHRB             (OCINSTRUCTION_SHR | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SHRL             (OCINSTRUCTION_SHR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SHRQ             (OCINSTRUCTION_SHR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SHRW             (OCINSTRUCTION_SHR | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_XORB             (OCINSTRUCTION_XOR | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_XORL             (OCINSTRUCTION_XOR | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_XORQ             (OCINSTRUCTION_XOR | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_XORW             (OCINSTRUCTION_XOR | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SETA             (OCINSTRUCTION_SETx | OCINSTRUCTION_A)
#define OCINSTRUCTION_SETAE            (OCINSTRUCTION_SETx | OCINSTRUCTION_AE)
#define OCINSTRUCTION_SETB             (OCINSTRUCTION_SETx | OCINSTRUCTION_B)
#define OCINSTRUCTION_SETBE            (OCINSTRUCTION_SETx | OCINSTRUCTION_BE)
#define OCINSTRUCTION_SETE             (OCINSTRUCTION_SETx | OCINSTRUCTION_E)
#define OCINSTRUCTION_SETG             (OCINSTRUCTION_SETx | OCINSTRUCTION_G)
#define OCINSTRUCTION_SETGE            (OCINSTRUCTION_SETx | OCINSTRUCTION_GE)
#define OCINSTRUCTION_SETL             (OCINSTRUCTION_SETx | OCINSTRUCTION_L)
#define OCINSTRUCTION_SETLE            (OCINSTRUCTION_SETx | OCINSTRUCTION_LE)
#define OCINSTRUCTION_SETNE            (OCINSTRUCTION_SETx | OCINSTRUCTION_NE)
#define OCINSTRUCTION_SETNS            (OCINSTRUCTION_SETx | OCINSTRUCTION_NS)
#define OCINSTRUCTION_SETO             (OCINSTRUCTION_SETx | OCINSTRUCTION_O)
#define OCINSTRUCTION_SETS             (OCINSTRUCTION_SETx | OCINSTRUCTION_S)
#define OCINSTRUCTION_CMOVA            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_A)
#define OCINSTRUCTION_CMOVAE           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_AE)
#define OCINSTRUCTION_CMOVB            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_B)
#define OCINSTRUCTION_CMOVBE           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_BE)
#define OCINSTRUCTION_CMOVE            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_E)
#define OCINSTRUCTION_CMOVG            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_G)
#define OCINSTRUCTION_CMOVGE           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_GE)
#define OCINSTRUCTION_CMOVL            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_L)
#define OCINSTRUCTION_CMOVLE           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_LE)
#define OCINSTRUCTION_CMOVNE           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_NE)
#define OCINSTRUCTION_CMOVNS           (OCINSTRUCTION_CMOVx | OCINSTRUCTION_NS)
#define OCINSTRUCTION_CMOVS            (OCINSTRUCTION_CMOVx | OCINSTRUCTION_S)
#define OCINSTRUCTION_MOVB             (OCINSTRUCTION_MOV | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_MOVL             (OCINSTRUCTION_MOV | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVQ             (OCINSTRUCTION_MOV | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MOVW             (OCINSTRUCTION_MOV | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_MOVSB            (OCINSTRUCTION_MOVS | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_MOVSD            (OCINSTRUCTION_MOVS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVSL            (OCINSTRUCTION_MOVS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVSQ            (OCINSTRUCTION_MOVS | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MOVSW            (OCINSTRUCTION_MOVS | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_MOVSBL           (OCINSTRUCTION_MOVSx | OCINSTRUCTION_8BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVSBQ           (OCINSTRUCTION_MOVSx | OCINSTRUCTION_8BIT | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MOVSLQ           (OCINSTRUCTION_MOVSx | OCINSTRUCTION_32BIT | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MOVSWL           (OCINSTRUCTION_MOVSx | OCINSTRUCTION_16BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVSWQ           (OCINSTRUCTION_MOVSx | OCINSTRUCTION_16BIT | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_MOVZBL           (OCINSTRUCTION_MOVZx | OCINSTRUCTION_8BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_MOVZWL           (OCINSTRUCTION_MOVZx | OCINSTRUCTION_16BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_FLDB             (OCINSTRUCTION_FLD | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_FLDL             (OCINSTRUCTION_FLD | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_FLDQ             (OCINSTRUCTION_FLD | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_FLDW             (OCINSTRUCTION_FLD | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_FLD1             (OCINSTRUCTION_FLD | OCINSTRUCTION_ONE)
#define OCINSTRUCTION_FLDZ             (OCINSTRUCTION_FLD | OCINSTRUCTION_ZERO)
#define OCINSTRUCTION_FLDPI            (OCINSTRUCTION_FLD | OCINSTRUCTION_PI)
#define OCINSTRUCTION_FLDL2E           (OCINSTRUCTION_FLD | OCINSTRUCTION_LOG2 | OCINSTRUCTION_E)
#define OCINSTRUCTION_FLDL2T           (OCINSTRUCTION_FLD | OCINSTRUCTION_LOG2 | OCINSTRUCTION_TEN)
#define OCINSTRUCTION_FLDLG2           (OCINSTRUCTION_FLD | OCINSTRUCTION_LOG10 | OCINSTRUCTION_TWO)
#define OCINSTRUCTION_FLDLN2           (OCINSTRUCTION_FLD | OCINSTRUCTION_LOGE | OCINSTRUCTION_TWO)
#define OCINSTRUCTION_FSTPB            (OCINSTRUCTION_FSTP | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_FSTPL            (OCINSTRUCTION_FSTP | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_FSTPQ            (OCINSTRUCTION_FSTP | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_FSTPW            (OCINSTRUCTION_FSTP | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_LEAB             (OCINSTRUCTION_LEA | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_LEAL             (OCINSTRUCTION_LEA | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_LEAQ             (OCINSTRUCTION_LEA | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_LEAW             (OCINSTRUCTION_LEA | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_CWTL             (OCINSTRUCTION_Cxxx | OCINSTRUCTION_16BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CLTQ             (OCINSTRUCTION_Cxxx | OCINSTRUCTION_32BIT | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_CQTO             (OCINSTRUCTION_Cxxx | OCINSTRUCTION_64BIT | OCINSTRUCTION_128BIT)
#define OCINSTRUCTION_CBW              (OCINSTRUCTION_Cyyy | OCINSTRUCTION_8BIT  | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_CWDE             (OCINSTRUCTION_Cyyy | OCINSTRUCTION_16BIT | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CDQE             (OCINSTRUCTION_Cyyy | OCINSTRUCTION_64BIT | OCINSTRUCTION_128BIT)
#define OCINSTRUCTION_CMPSB            (OCINSTRUCTION_CMPS | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_CMPSL            (OCINSTRUCTION_CMPS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CMPSQ            (OCINSTRUCTION_CMPS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_CMPSW            (OCINSTRUCTION_CMPS | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_SCASB            (OCINSTRUCTION_SCAS | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_SCASL            (OCINSTRUCTION_SCAS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_SCASQ            (OCINSTRUCTION_SCAS | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_SCASW            (OCINSTRUCTION_SCAS | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_STOSB            (OCINSTRUCTION_STOS | OCINSTRUCTION_8BIT)
#define OCINSTRUCTION_STOSL            (OCINSTRUCTION_STOS | OCINSTRUCTION_32BIT)
#define OCINSTRUCTION_STOSQ            (OCINSTRUCTION_STOS | OCINSTRUCTION_64BIT)
#define OCINSTRUCTION_STOSW            (OCINSTRUCTION_STOS | OCINSTRUCTION_16BIT)
#define OCINSTRUCTION_FNINIT           (OCINSTRUCTION_FINIT | OCINSTRUCTION_NOCHECK)

#define OCOPERAND_IVALUE0              (0x01)
#define OCOPERAND_UVALUE0              (0x02)
#define OPOPERAND_REGISTER0            (0x03)
#define OCOPERAND_IVALUE1              (0x04)
#define OCOPERAND_UVALUE1              (0x08)
#define OPOPERAND_REGISTER1            (0x0c)
#define OCOPERAND_IVALUE2              (0x10)
#define OCOPERAND_UVALUE2              (0x20)
#define OPOPERAND_REGISTER2            (0x30)
#define OCOPERAND_IVALUE3              (0x40)
#define OCOPERAND_UVALUE3              (0x80)
#define OPOPERAND_REGISTER3            (0xc0)

#define OPOPERAND_SIZE                 U64MASK(51)
// ----- GAP OPSIZE -----
#define OPOPERAND_SEGMENT              U64MASK(55)
// ---- GAP OPSEGMENT ----
#define OCOPERAND_ABSOLUTE             U64MASK(62)

#define OPSIZE_BYTEPTR                 (U64MASK(52) | OPOPERAND_SIZE)
#define OPSIZE_WORDPTR                 (U64MASK(53) | OPOPERAND_SIZE)
#define OPSIZE_DWORDPTR                (U64MASK(54) | OPOPERAND_SIZE)

#define OPSEGMENT_CS                   (U64MASK(56) | OPOPERAND_SEGMENT)
#define OPSEGMENT_DS                   (U64MASK(57) | OPOPERAND_SEGMENT)
#define OPSEGMENT_SS                   (U64MASK(58) | OPOPERAND_SEGMENT)
#define OPSEGMENT_ES                   (U64MASK(59) | OPOPERAND_SEGMENT)
#define OPSEGMENT_GS                   (U64MASK(60) | OPOPERAND_SEGMENT)
#define OPSEGMENT_FS                   (U64MASK(61) | OPOPERAND_SEGMENT)

#define OCREGISTER_XMM                 U64MASK(42)
#define OCREGISTER_YMM                 U64MASK(43)
#define OCREGISTER_ZMM                 U64MASK(44)
#define OCREGISTER_GENERAL             U64MASK(45)
#define OCREGISTER_INSTRUCTIONPTR      U64MASK(46)
#define OCREGISTER_BASEPTR             U64MASK(47)
#define OCREGISTER_STACKIDX            U64MASK(48)
#define OCREGISTER_STACKPTR            U64MASK(49)
#define OCREGISTER_DSTINDEX            U64MASK(50)
#define OCREGISTER_SRCINDEX            U64MASK(51)
#define OCREGISTER_DATA                U64MASK(52)
#define OCREGISTER_COUNTER             U64MASK(53)
#define OCREGISTER_BASE                U64MASK(54)
#define OCREGISTER_ACCUMULATOR         U64MASK(55)
#define OCREGISTER_8BITLO              U64MASK(56)
#define OCREGISTER_8BITHI              U64MASK(57)
#define OCREGISTER_16BIT               U64MASK(58)
#define OCREGISTER_32BIT               U64MASK(59)
#define OCREGISTER_64BIT               U64MASK(60)
#define OCREGISTER_128BIT              U64MASK(61)
#define OCREGISTER_256BIT              U64MASK(62)
#define OCREGISTER_512BIT              U64MASK(63)

#define OCREGISTER_RAX                 ((0x01) | OCREGISTER_64BIT  | OCREGISTER_ACCUMULATOR)
#define OCREGISTER_EAX                 ((0x02) | OCREGISTER_32BIT  | OCREGISTER_ACCUMULATOR)
#define OCREGISTER_AX                  ((0x03) | OCREGISTER_16BIT  | OCREGISTER_ACCUMULATOR)
#define OCREGISTER_AH                  ((0x04) | OCREGISTER_8BITHI | OCREGISTER_ACCUMULATOR)
#define OCREGISTER_AL                  ((0x05) | OCREGISTER_8BITLO | OCREGISTER_ACCUMULATOR)

#define OCREGISTER_RBX                 ((0x06) | OCREGISTER_64BIT  | OCREGISTER_BASE)
#define OCREGISTER_EBX                 ((0x07) | OCREGISTER_32BIT  | OCREGISTER_BASE)
#define OCREGISTER_BX                  ((0x08) | OCREGISTER_16BIT  | OCREGISTER_BASE)
#define OCREGISTER_BH                  ((0x09) | OCREGISTER_8BITHI | OCREGISTER_BASE)
#define OCREGISTER_BL                  ((0x0a) | OCREGISTER_8BITLO | OCREGISTER_BASE)

#define OCREGISTER_RCX                 ((0x0b) | OCREGISTER_64BIT  | OCREGISTER_COUNTER)
#define OCREGISTER_ECX                 ((0x0c) | OCREGISTER_32BIT  | OCREGISTER_COUNTER)
#define OCREGISTER_CX                  ((0x0d) | OCREGISTER_16BIT  | OCREGISTER_COUNTER)
#define OCREGISTER_CH                  ((0x0e) | OCREGISTER_8BITHI | OCREGISTER_COUNTER)
#define OCREGISTER_CL                  ((0x0f) | OCREGISTER_8BITLO | OCREGISTER_COUNTER)

#define OCREGISTER_RDX                 ((0x10) | OCREGISTER_64BIT  | OCREGISTER_DATA)
#define OCREGISTER_EDX                 ((0x11) | OCREGISTER_32BIT  | OCREGISTER_DATA)
#define OCREGISTER_DX                  ((0x12) | OCREGISTER_16BIT  | OCREGISTER_DATA)
#define OCREGISTER_DH                  ((0x13) | OCREGISTER_8BITHI | OCREGISTER_DATA)
#define OCREGISTER_DL                  ((0x14) | OCREGISTER_8BITLO | OCREGISTER_DATA)

#define OCREGISTER_R8B                 ((0x15) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R8D                 ((0x16) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R8W                 ((0x17) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R8                  ((0x18) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R9B                 ((0x19) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R9D                 ((0x1a) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R9W                 ((0x1b) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R9                  ((0x1c) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R10B                ((0x1d) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R10D                ((0x1e) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R10W                ((0x1f) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R10                 ((0x20) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R11B                ((0x21) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R11D                ((0x22) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R11W                ((0x23) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R11                 ((0x24) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R12B                ((0x25) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R12D                ((0x26) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R12W                ((0x27) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R12                 ((0x28) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R13B                ((0x29) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R13D                ((0x2a) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R13W                ((0x2b) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R13                 ((0x2c) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R14B                ((0x2d) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R14D                ((0x2e) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R14W                ((0x2f) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R14                 ((0x30) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_R15B                ((0x31) | OCREGISTER_8BITLO | OCREGISTER_GENERAL)
#define OCREGISTER_R15D                ((0x32) | OCREGISTER_32BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R15W                ((0x33) | OCREGISTER_16BIT  | OCREGISTER_GENERAL)
#define OCREGISTER_R15                 ((0x34) | OCREGISTER_64BIT  | OCREGISTER_GENERAL)

#define OCREGISTER_RSI                 ((0x35) | OCREGISTER_64BIT  | OCREGISTER_SRCINDEX)
#define OCREGISTER_ESI                 ((0x36) | OCREGISTER_32BIT  | OCREGISTER_SRCINDEX)
#define OCREGISTER_SIL                 ((0x37) | OCREGISTER_8BITLO | OCREGISTER_SRCINDEX)
#define OCREGISTER_SI                  ((0x38) | OCREGISTER_16BIT  | OCREGISTER_SRCINDEX)

#define OCREGISTER_RDI                 ((0x39) | OCREGISTER_64BIT  | OCREGISTER_DSTINDEX)
#define OCREGISTER_EDI                 ((0x3a) | OCREGISTER_32BIT  | OCREGISTER_DSTINDEX)
#define OCREGISTER_DIL                 ((0x3b) | OCREGISTER_8BITLO | OCREGISTER_DSTINDEX)
#define OCREGISTER_DI                  ((0x3c) | OCREGISTER_16BIT  | OCREGISTER_DSTINDEX)

#define OCREGISTER_RSP                 ((0x3d) | OCREGISTER_64BIT  | OCREGISTER_STACKPTR)
#define OCREGISTER_ESP                 ((0x3e) | OCREGISTER_32BIT  | OCREGISTER_STACKPTR)
#define OCREGISTER_SPL                 ((0x3f) | OCREGISTER_8BITLO | OCREGISTER_STACKPTR)
#define OCREGISTER_SP                  ((0x40) | OCREGISTER_16BIT  | OCREGISTER_STACKPTR)

#define OCREGISTER_RBP                 ((0x41) | OCREGISTER_64BIT  | OCREGISTER_BASEPTR)
#define OCREGISTER_EBP                 ((0x42) | OCREGISTER_32BIT  | OCREGISTER_BASEPTR)
#define OCREGISTER_BPL                 ((0x43) | OCREGISTER_8BITLO | OCREGISTER_BASEPTR)
#define OCREGISTER_BP                  ((0x44) | OCREGISTER_16BIT  | OCREGISTER_BASEPTR)

#define OCREGISTER_RIP                 ((0x45) | OCREGISTER_64BIT  | OCREGISTER_INSTRUCTIONPTR)
#define OCREGISTER_EIP                 ((0x46) | OCREGISTER_32BIT  | OCREGISTER_INSTRUCTIONPTR)
#define OCREGISTER_IP                  ((0x47) | OCREGISTER_16BIT  | OCREGISTER_INSTRUCTIONPTR)

#define OCREGISTER_XMM0                ((0x48) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM1                ((0x49) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM2                ((0x4a) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM3                ((0x4b) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM4                ((0x4c) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM5                ((0x4d) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM6                ((0x4e) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM7                ((0x4f) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM8                ((0x50) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM9                ((0x51) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM10               ((0x52) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM11               ((0x53) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM12               ((0x54) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM13               ((0x55) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM14               ((0x56) | OCREGISTER_128BIT | OCREGISTER_XMM)
#define OCREGISTER_XMM15               ((0x57) | OCREGISTER_128BIT | OCREGISTER_XMM)

#define OCREGISTER_YMM0                ((0x58) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM1                ((0x59) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM2                ((0x5a) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM3                ((0x5b) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM4                ((0x5c) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM5                ((0x5d) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM6                ((0x5e) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM7                ((0x5f) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM8                ((0x60) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM9                ((0x61) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM10               ((0x62) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM11               ((0x63) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM12               ((0x64) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM13               ((0x65) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM14               ((0x66) | OCREGISTER_256BIT | OCREGISTER_YMM)
#define OCREGISTER_YMM15               ((0x67) | OCREGISTER_256BIT | OCREGISTER_YMM)

#define OCREGISTER_ZMM0                ((0x68) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM1                ((0x69) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM2                ((0x6a) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM3                ((0x6b) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM4                ((0x6c) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM5                ((0x6d) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM6                ((0x6e) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM7                ((0x6f) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM8                ((0x70) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM9                ((0x71) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM10               ((0x72) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM11               ((0x73) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM12               ((0x74) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM13               ((0x75) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM14               ((0x76) | OCREGISTER_512BIT | OCREGISTER_ZMM)
#define OCREGISTER_ZMM15               ((0x77) | OCREGISTER_512BIT | OCREGISTER_ZMM)

#define OCREGISTER_ST                  ((0x78) | OCREGISTER_STACKIDX)

#define MODE_OCEXAMINE                 (MODE_PUT0('O') | MODE_PUT1('C') | MODE_PUT2('E'))

typedef struct ocmnemonic_s {
  char       data[160];
  uint64_t   cvalue;
  union {
    int64_t  ivalue;
    uint64_t uvalue;
  };
} ocmnemonic_t, *pocmnemonic_t;

typedef struct ocoperand_s {
  char       data[160];
  uint64_t   cvalue;
  union {
    int64_t  ivalue0;
    uint64_t uvalue0;
  };
  union {
    int64_t  ivalue1;
    uint64_t uvalue1;
  };
  union {
    int64_t  ivalue2;
    uint64_t uvalue2;
  };
  union {
    int64_t  ivalue3;
    uint64_t uvalue3;
  };
} ocoperand_t, *pocoperand_t;

typedef struct ocexamine_s {
  smode_t    mode;
  uint64_t   vaddr;
  char       comment[160];

  pocmnemonic_t mc;
  pocoperand_t  op1;
  pocoperand_t  op2;
  pocoperand_t  op3;
} ocexamine_t, *pocexamine_t;

bool_t isocexamine(handle_t p);

handle_t oemalloc();
handle_t oefree(handle_t p);
handle_t oecreate(handle_t p, const uint64_t vaddr, unknown_t mnemonic, unknown_t operands);

unknown_t oeget(handle_t p, const imode_t mode);
unknown_t oejump(unknown_t p, const size_t size);
unknown_t oeskip(unknown_t p, const size_t size);
size_t    oeskipdec(unknown_t p, const size_t size);
size_t    oeskiphex(unknown_t p, const size_t size);

uint64_t  oedecb(unknown_t p, const size_t size);
uint64_t  oehexb(unknown_t p, const size_t size);
bool_t    oeisdecb(unknown_t p, const size_t size);
bool_t    oeishexb(unknown_t p, const size_t size);

#endif

